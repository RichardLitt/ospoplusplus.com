var q,jsonFeedUrl="/search.json",$searchForm="[data-search-form]",$searchInput=$("[data-search-input]"),$resultTemplate=$("#search-result"),$resultsPlaceholder=$("[data-search-results]"),$foundContainer=$("[data-search-found]"),$foundTerm=$("[data-search-found-term]"),$foundCount=$("[data-search-found-count]"),allowEmpty=!0,showLoader=!0,loadingClass="is--loading";function initSearch(){getParameterByName("q")&&(q=decodeURIComponent(getParameterByName("q")),$searchInput.val(q),execSearch(q)),$(document).on("submit",$searchForm,function(e){e.preventDefault(),execSearch(q=$searchInput.val())})}function execSearch(e){(""!=e||allowEmpty)&&(showLoader&&toggleLoadingClass(),getSearchResults(processData()))}function toggleLoadingClass(){$resultsPlaceholder.toggleClass(loadingClass),$foundContainer.toggleClass(loadingClass)}function getSearchResults(e){$.get(BASE_URL+jsonFeedUrl,e,"json")}function processData(){return $results=[],function(e){var a=0,o="";$.each(e,function(e,t){if(-1<t.excerpt.toLowerCase().indexOf(q.toLowerCase())||-1<t.title.toLowerCase().indexOf(q.toLowerCase())){var n=populateResultContent($resultTemplate.html(),t);a++,o+=n}}),showLoader&&toggleLoadingClass(),populateResultsString(a),showSearchResults(o)}}function showSearchResults(e){$resultsPlaceholder.html(e)}function populateResultContent(e,t){return e=injectContent(e=injectContent(e=injectContent(e=injectContent(e,t.title,"##Title##"),t.link,"##Url##"),t.excerpt,"##Excerpt##"),t.date,"##Date##")}function populateResultsString(e){$foundTerm.text(q),$foundCount.text(e),$foundContainer.show()}function getParameterByName(e){var t=RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);return t&&decodeURIComponent(t[1].replace(/\+/g," "))}function injectContent(e,t,n){var a=new RegExp(n,"g");return e.replace(a,t)}$(document).ready(function(){$foundContainer.hide(),initSearch()});