var q,jsonFeedUrl="/search.json",$searchForm="[data-search-form]",$searchInput=$("[data-search-input]"),$resultTemplate=$("#search-result"),$resultsPlaceholder=$("[data-search-results]"),$foundContainer=$("[data-search-found]"),$foundTerm=$("[data-search-found-term]"),$foundCount=$("[data-search-found-count]"),allowEmpty=!0,showLoader=!0,loadingClass="is--loading";function initSearch(){getParameterByName("q")&&(q=decodeURIComponent(getParameterByName("q")),$searchInput.val(q),execSearch(q)),$(document).on("submit",$searchForm,function(e){e.preventDefault(),execSearch(q=$searchInput.val())})}function execSearch(e){(""!=e||allowEmpty)&&(showLoader&&toggleLoadingClass(),getSearchResults(processData()))}function toggleLoadingClass(){$resultsPlaceholder.toggleClass(loadingClass),$foundContainer.toggleClass(loadingClass)}function getSearchResults(e){$.get(BASE_URL+jsonFeedUrl,e,"json")}function processData(){return $results=[],function(e){var i=0,a="";$.each(e,function(e,t){if(-1<t.excerpt.toLowerCase().indexOf(q.toLowerCase())||-1<t.title.toLowerCase().indexOf(q.toLowerCase())){var n=populateResultContent($resultTemplate.html(),t);i++,a+=n}}),showLoader&&toggleLoadingClass(),populateResultsString(i),showSearchResults(a)}}function showSearchResults(e){$resultsPlaceholder.html(e)}function populateResultContent(e,t){return e=injectContent(e=injectContent(e=injectContent(e=injectContent(e,t.title,"##Title##"),t.link,"##Url##"),t.excerpt,"##Excerpt##"),t.date,"##Date##")}function populateResultsString(e){$foundTerm.text(q),$foundCount.text(e),$foundContainer.show()}function getParameterByName(e){var t=RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);return t&&decodeURIComponent(t[1].replace(/\+/g," "))}function injectContent(e,t,n){var i=new RegExp(n,"g");return e.replace(i,t)}$(document).ready(function(){$foundContainer.hide(),initSearch()}),function(a){"use strict";a.fn.fitVids=function(e){var n={customSelector:null};if(!document.getElementById("fit-vids-style")){var t=document.createElement("div"),i=document.getElementsByTagName("base")[0]||document.getElementsByTagName("script")[0];t.className="fit-vids-style",t.id="fit-vids-style",t.style.display="none",t.innerHTML="&shy;<style>.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style>",i.parentNode.insertBefore(t,i)}return e&&a.extend(n,e),this.each(function(){var e=["iframe[src*='player.vimeo.com']","iframe[src*='youtube.com']","iframe[src*='youtube-nocookie.com']","iframe[src*='kickstarter.com'][src*='video.html']","object","embed"];n.customSelector&&e.push(n.customSelector);var t=a(this).find(e.join(","));(t=t.not("object object")).each(function(){var e=a(this);if(!("embed"===this.tagName.toLowerCase()&&e.parent("object").length||e.parent(".fluid-width-video-wrapper").length)){var t=("object"===this.tagName.toLowerCase()||e.attr("height")&&!isNaN(parseInt(e.attr("height"),10))?parseInt(e.attr("height"),10):e.height())/(isNaN(parseInt(e.attr("width"),10))?e.width():parseInt(e.attr("width"),10));if(!e.attr("id")){var n="fitvid"+Math.floor(999999*Math.random());e.attr("id",n)}e.wrap('<div class="fluid-width-video-wrapper"></div>').parent(".fluid-width-video-wrapper").css("padding-top",100*t+"%"),e.removeAttr("height").removeAttr("width")}})})}}(window.jQuery||window.Zepto),window.matchMedia=window.matchMedia||function(e,t){"use strict";var n,i=e.documentElement,a=i.firstElementChild||i.firstChild,o=e.createElement("body"),r=e.createElement("div");return r.id="mq-test-1",r.style.cssText="position:absolute;top:-100em",o.style.background="none",o.appendChild(r),function(e){return r.innerHTML='&shy;<style media="'+e+'"> #mq-test-1 { width: 42px; }</style>',i.insertBefore(o,a),n=42===r.offsetWidth,i.removeChild(o),{matches:n,media:e}}}(document),function(v){"use strict";var e={};if((v.respond=e).update=function(){},e.mediaQueriesSupported=v.matchMedia&&v.matchMedia("only all").matches,!e.mediaQueriesSupported){var y,w,E,C=v.document,$=C.documentElement,b=[],x=[],T=[],o={},S=C.getElementsByTagName("head")[0]||$,r=C.getElementsByTagName("base")[0],N=S.getElementsByTagName("link"),s=[],t=function(){for(var e=0;e<N.length;e++){var t=N[e],n=t.href,i=t.media,a=t.rel&&"stylesheet"===t.rel.toLowerCase();n&&a&&!o[n]&&(t.styleSheet&&t.styleSheet.rawCssText?(c(t.styleSheet.rawCssText,n,i),o[n]=!0):(/^([a-zA-Z:]*\/\/)/.test(n)||r)&&n.replace(RegExp.$1,"").split("/")[0]!==v.location.host||s.push({href:n,media:i}))}l()},l=function(){if(s.length){var t=s.shift();n(t.href,function(e){c(e,t.href,t.media),o[t.href]=!0,v.setTimeout(function(){l()},0)})}},c=function(e,t,n){var i=e.match(/@media[^\{]+\{([^\{\}]*\{[^\}\{]*\})+/gi),a=i&&i.length||0,o=function(e){return e.replace(/(url\()['"]?([^\/\)'"][^:\)'"]+)['"]?(\))/g,"$1"+t+"$2$3")},r=!a&&n;(t=t.substring(0,t.lastIndexOf("/"))).length&&(t+="/"),r&&(a=1);for(var s=0;s<a;s++){var l,c,d,u;r?(l=n,x.push(o(e))):(l=i[s].match(/@media *([^\{]+)\{([\S\s]+?)$/)&&RegExp.$1,x.push(RegExp.$2&&o(RegExp.$2))),u=(d=l.split(",")).length;for(var h=0;h<u;h++)c=d[h],b.push({media:c.split("(")[0].match(/(only\s+)?([a-zA-Z]+)\s?/)&&RegExp.$2||"all",rules:x.length-1,hasquery:-1<c.indexOf("("),minw:c.match(/\(\s*min\-width\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/)&&parseFloat(RegExp.$1)+(RegExp.$2||""),maxw:c.match(/\(\s*max\-width\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/)&&parseFloat(RegExp.$1)+(RegExp.$2||"")})}j()},_=function(){var e,t=C.createElement("div"),n=C.body,i=!1;return t.style.cssText="position:absolute;font-size:1em;width:1em",n||((n=i=C.createElement("body")).style.background="none"),n.appendChild(t),$.insertBefore(n,$.firstChild),e=t.offsetWidth,i?$.removeChild(n):n.removeChild(t),e=E=parseFloat(e)},j=function(e){var t="clientWidth",n=$[t],i="CSS1Compat"===C.compatMode&&n||C.body[t]||n,a={},o=N[N.length-1],r=(new Date).getTime();if(e&&y&&r-y<30)return v.clearTimeout(w),void(w=v.setTimeout(j,30));for(var s in y=r,b)if(b.hasOwnProperty(s)){var l=b[s],c=l.minw,d=l.maxw,u=null===c,h=null===d;c&&(c=parseFloat(c)*(-1<c.indexOf("em")?E||_():1)),d&&(d=parseFloat(d)*(-1<d.indexOf("em")?E||_():1)),l.hasquery&&(u&&h||!(u||c<=i)||!(h||i<=d))||(a[l.media]||(a[l.media]=[]),a[l.media].push(x[l.rules]))}for(var p in T)T.hasOwnProperty(p)&&T[p]&&T[p].parentNode===S&&S.removeChild(T[p]);for(var f in a)if(a.hasOwnProperty(f)){var m=C.createElement("style"),g=a[f].join("\n");m.type="text/css",m.media=f,S.insertBefore(m,o.nextSibling),m.styleSheet?m.styleSheet.cssText=g:m.appendChild(C.createTextNode(g)),T.push(m)}},n=function(e,t){var n=i();n&&(n.open("GET",e,!0),n.onreadystatechange=function(){4!==n.readyState||200!==n.status&&304!==n.status||t(n.responseText)},4!==n.readyState&&n.send(null))},i=function(){var t=!1;try{t=new v.XMLHttpRequest}catch(e){t=new v.ActiveXObject("Microsoft.XMLHTTP")}return function(){return t}}();t(),e.update=t,v.addEventListener?v.addEventListener("resize",a,!1):v.attachEvent&&v.attachEvent("onresize",a)}function a(){j(!0)}}(this);var responsiveNav=function(n,i){var a=!!n.getComputedStyle;n.getComputedStyle||(n.getComputedStyle=function(n){return this.el=n,this.getPropertyValue=function(e){var t=/(\-([a-z]){1})/g;return"float"===e&&(e="styleFloat"),t.test(e)&&(e=e.replace(t,function(){return arguments[2].toUpperCase()})),n.currentStyle[e]?n.currentStyle[e]:null},this});var o,r,s,l,c=i.documentElement,e=i.getElementsByTagName("head")[0],d=i.createElement("style"),t=!1,u=function(t,n,i,a){if("addEventListener"in t)try{t.addEventListener(n,i,a)}catch(e){if("object"!=typeof i||!i.handleEvent)throw e;t.addEventListener(n,function(e){i.handleEvent.call(i,e)},a)}else"attachEvent"in t&&("object"==typeof i&&i.handleEvent?t.attachEvent("on"+n,function(){i.handleEvent.call(i)}):t.attachEvent("on"+n,i))},h=function(t,n,i,a){if("removeEventListener"in t)try{t.removeEventListener(n,i,a)}catch(e){if("object"!=typeof i||!i.handleEvent)throw e;t.removeEventListener(n,function(e){i.handleEvent.call(i,e)},a)}else"detachEvent"in t&&("object"==typeof i&&i.handleEvent?t.detachEvent("on"+n,function(){i.handleEvent.call(i)}):t.detachEvent("on"+n,i))},p=function(e,t){for(var n in t)e.setAttribute(n,t[n])},f=function(e,t){e.className+=" "+t,e.className=e.className.replace(/(^\s*)|(\s*$)/g,"")},m=function(e,t){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ").replace(/(^\s*)|(\s*$)/g,"")},g=function(e,t){var n;for(n in this.options={animate:!0,transition:400,label:"Menu",insert:"after",customToggle:"",openPos:"relative",jsClass:"js",init:function(){},open:function(){},close:function(){}},t)this.options[n]=t[n];if(f(c,this.options.jsClass),this.wrapperEl=e.replace("#",""),!i.getElementById(this.wrapperEl))throw new Error("The nav element you are trying to select doesn't exist");this.wrapper=i.getElementById(this.wrapperEl),this.wrapper.inner=function(e){for(var t=e.firstChild;null!==t&&1!==t.nodeType;)t=t.nextSibling;return t}(this.wrapper),r=this.options,o=this.wrapper,this._init(this)};return g.prototype={destroy:function(){this._removeStyles(),m(o,"closed"),m(o,"opened"),o.removeAttribute("style"),o.removeAttribute("aria-hidden"),l=o=null,h(n,"load",this,!1),h(n,"resize",this,!1),h(s,"mousedown",this,!1),h(s,"touchstart",this,!1),h(s,"touchend",this,!1),h(s,"keyup",this,!1),h(s,"click",this,!1),r.customToggle?s.removeAttribute("aria-hidden"):s.parentNode.removeChild(s)},toggle:function(){t?(m(o,"opened"),f(o,"closed"),p(o,{"aria-hidden":"true"}),t=!1,r.close()):(m(o,"closed"),f(o,"opened"),o.style.position=r.openPos,p(o,{"aria-hidden":"false"}),t=!0,r.open())},handleEvent:function(e){var t=e||n.event;switch(t.type){case"mousedown":this._onmousedown(t);break;case"touchstart":this._ontouchstart(t);break;case"touchend":this._ontouchend(t);break;case"keyup":this._onkeyup(t);break;case"click":this._onclick(t);break;case"load":this._transitions(t),this._resize(t);break;case"resize":this._resize(t)}},_init:function(){f(o,"closed"),this._createToggle(),u(n,"load",this,!1),u(n,"resize",this,!1),u(s,"mousedown",this,!1),u(s,"touchstart",this,!1),u(s,"touchend",this,!1),u(s,"keyup",this,!1),u(s,"click",this,!1)},_createStyles:function(){d.parentNode||e.appendChild(d)},_removeStyles:function(){d.parentNode&&d.parentNode.removeChild(d)},_createToggle:function(){if(r.customToggle){var e=r.customToggle.replace("#","");if(!i.getElementById(e))throw new Error("The custom nav toggle you are trying to select doesn't exist");s=i.getElementById(e)}else{var t=i.createElement("a");t.innerHTML=r.label,p(t,{href:"#",id:"nav-toggle"}),"after"===r.insert?o.parentNode.insertBefore(t,o.nextSibling):o.parentNode.insertBefore(t,o),s=i.getElementById("nav-toggle")}},_preventDefault:function(e){e.preventDefault?(e.preventDefault(),e.stopPropagation()):e.returnValue=!1},_onmousedown:function(e){var t=e||n.event;3!==t.which&&2!==t.button&&(this._preventDefault(e),this.toggle(e))},_ontouchstart:function(e){s.onmousedown=null,this._preventDefault(e),this.toggle(e)},_ontouchend:function(){var e=this;o.addEventListener("click",e._preventDefault,!0),setTimeout(function(){o.removeEventListener("click",e._preventDefault,!0)},r.transition)},_onkeyup:function(e){13===(e||n.event).keyCode&&this.toggle(e)},_onclick:function(e){this._preventDefault(e)},_transitions:function(){if(r.animate){var e=o.style,t="max-height "+r.transition+"ms";e.WebkitTransition=t,e.MozTransition=t,e.OTransition=t,e.transition=t}},_calcHeight:function(){var e=o.inner.offsetHeight,t="#"+this.wrapperEl+".opened{max-height:"+e+"px}";a&&(d.innerHTML=t,t="")},_resize:function(){"none"!==n.getComputedStyle(s,null).getPropertyValue("display")?(p(s,{"aria-hidden":"false"}),o.className.match(/(^|\s)closed(\s|$)/)&&(p(o,{"aria-hidden":"true"}),o.style.position="absolute"),this._createStyles(),this._calcHeight()):(p(s,{"aria-hidden":"true"}),p(o,{"aria-hidden":"false"}),o.style.position=r.openPos,this._removeStyles()),r.init()}},function(e,t){return l||(l=new g(e,t)),l}}(window,document),navigation=responsiveNav("#site-nav",{animate:!1,transition:0,label:"<i class='fa fa-bars'></i> Menu",insert:"before",customToggle:"",openPos:"relative",jsClass:"js",init:function(){},open:function(){},close:function(){}});$("html").click(function(){$(navigation.wrapper).hasClass("opened")&&navigation.toggle()}),$("#site-nav").click(function(e){e.stopPropagation()}),$(function(){$("article").fitVids()}),$("a[href$='.jpg'],a[href$='.jpeg'],a[href$='.JPG'],a[href$='.png'],a[href$='.gif']").addClass("image-popup");